---
import type { Bandori } from "@hina-is/bestdori/data";

import { colord } from "colord";

import { IMAGE_FORMAT } from "~/lib/compressor/constants";

interface Props {
	character: Bandori.Character & { id: number };
	displayBand: boolean;
	tooltip?: "auto" | "top" | "bottom";
}

const { character, displayBand, tooltip = "auto" } = Astro.props;

const { band } = character;
const color = colord(character.colorCode);
---

<div
	class:list={[
		"tooltip group",
		tooltip === "auto" && "even:tooltip-bottom",
		tooltip === "top" && "tooltip-top",
		tooltip === "bottom" && "tooltip-bottom",
	]}
>
	<div
		class:list={[
			"tooltip-content",
			color.brightness() < 0.67 ? "text-white" : "text-black",
		]}
		style={`--tt-bg: ${color.toHex()}`}
	>
		{
			displayBand ? (
				<div class="inline-flex items-center gap-1 group-even:flex-row-reverse">
					<div>
						{character.name} <br />
						<span class="font-medium">{band.name}</span>
					</div>

					<img
						class="size-8"
						src={`/assets/bands/${band.slug}.svg`}
						alt={`${band.name} icon`}
						loading="lazy"
					/>
				</div>
			) : (
				character.name
			)
		}
	</div>
	<img
		class="size-10"
		src={`/assets/characters/${character.slug}.${IMAGE_FORMAT}`}
		alt={`${character.name} icon`}
		loading="lazy"
	/>
</div>
